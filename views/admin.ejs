<head>
<title>NR v2 | Admin</title>
</head>

<link rel="stylesheet" type="text/css" href="css/style.css" />

<body>
<div id = 'superbigcontainer' onkeyup="customInput()">




  <div id='container'>

    <h1>Admin tool v1.0</h1>
    <div class = "menu">
     <button class="active"   id="create"       onclick="showclass('create')">Create</button>
     <button class="inactive" id="preview"      onclick="showclass('preview')">Preview</button>
     <button class="inactive" id="browse"       onclick="showclass('browse')">Browse</button>
     <button class="inactive" id="edit"         onclick="showclass('edit')">Edit</button>
     <button class="inactive" id="deploy"       onclick="showclass('deploy')">Deploy</button>
     </div>
   <div class = "content">

   <div  class="tab visible" id = "c">

       <h4 id="json">Dataset updated at: <span id='lastUpdate'>  <%= lastUpdate %>  </span></h4>
       <form method="post" action="/admin/refresh">
         <input type="submit" value="Get / Refresh dataset &#8635;"/>
       </form>

       <h4 id="json">Default dataset id: <span id=''>  <%= date %>  </span></h4>
       <p> URL (external) : <a target="_blank" href="https://newsapp-carb11.herokuapp.com/<%= date %>"/>https://newsapp-carb11.herokuapp.com/<%= date %></a><p>
       <p> URL (local) : <a target="_blank" href="localhost:5000/<%= date %>"/>localhost:5000/<%= date %></a><p>
       <form method="post" action="/admin/save/<%- date %>" >
         <input type="submit" value="Save dataset &#128190;"/>
       </form>

       <form method="post" action="" id="submitCustom" >
       <h4 id="json" >Customized dataset id: <input type="text" name="custom" id="customInput"  text=""> </input><span id="customButton" onclick="customInput()">&#9655;</span> </h4>
       <p> URL (external) : <a id="customExtUrl" target="_blank" href="https://newsapp-carb11.herokuapp.com/"/>https://newsapp-carb11.herokuapp.com/</a><p>
       <p> URL (local) : <a id="customLocalUrl" target="_blank" href="localhost:5000/"/>localhost:5000/</a><p>
       <input type="submit" value="Save custom path &#128190;" />
       </form>

     </div>

   <div  class="tab hidden" id = "p">

     <b>Sources(<%- resultArray.length %>)</b>
     <p id="json-content"><%- JSON.stringify(resultObject) %><p>

     </div>

   <div  class="tab hidden" id = "b">


     <ul id="viewDirs">
       
     </ul>
   </div>


   <div  class="tab hidden" id = "e">
     edit
   </div>

   <div  class="tab hidden" id = "d">
     deploy
   </div>


  </div>


    <div id ="more">
      <div id="git">Suivez ce projet sur <a href="https://github.com/Carburator11">Github</a></div>
      <div id="ln">Mon profil <a href="https://www.linkedin.com/in/pierrevautherin/">LinkedIn</a></div>
      <div id="v1">La premi√®re version de ce site : <a href="http://carb11.eu/newsroom/">Newsroom v1.0</a></div>
    </div>
  </div>

  </div>
</div>
</body>

<script>



var customId = document.getElementById('customInput').value;

function customInput(){
      customId = document.getElementById('customInput').value;
      document.getElementById("customExtUrl").href = "https://newsapp-carb11.herokuapp.com/" + customId ;
      document.getElementById("customExtUrl").innerHTML = "https://newsapp-carb11.herokuapp.com/" + customId ;
      document.getElementById("customLocalUrl").href = "localhost:5000/" + customId ;
      document.getElementById("customLocalUrl").innerHTML = "localhost:5000/" + customId ;
      document.getElementById("submitCustom").action = "/admin/save/"+ customId;

  }



function showclass(e){   //ugly solutions...
      document.getElementById("create").className =  "inactive";
      document.getElementById("preview").className = "inactive";
      document.getElementById("browse").className =  "inactive";
      document.getElementById("edit").className =    "inactive";
      document.getElementById("deploy").className =  "inactive";
      document.getElementById(e).className =         "active";

      document.getElementById('c').className = "tab hidden";
      document.getElementById('p').className = "tab hidden";
      document.getElementById('b').className = "tab hidden";
      document.getElementById('e').className = "tab hidden";
      document.getElementById('d').className = "tab hidden";
      document.getElementById(e.substring(0,1)).className = "tab visible";
      //alert(e.substring(0,1));
}



function showDirList(){

  for (var i = 0 ; i < <%- JSON.stringify(dirList)%>.length ; i++) {
    var filename = <%- JSON.stringify(dirList)%>[i];
    var id =  filename.substring(0, (filename.length - 5));
    var el = "<li>" + filename + "   <a href='http://localhost:5000/admin/edit/"+ id +"'>edit(local)</a>";
    el    +=  "   <a href='https://newsapp-carb11.herokuapp.com/admin/edit/"+ id +"'>edit(ext)</a></li>" ;
   document.getElementById('viewDirs').innerHTML += el ;
      }
}

showDirList();


</script>
